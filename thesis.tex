\documentclass[oneside,11pt,nocover,
  printed, %% This option enables the default options for the
           %% digital version of a document. Replace with `printed`
           %% to enable the default options for the printed version
           %% of a document.
  notable,   %% Causes the coloring of tables. Replace with `notable`
           %% to restore plain tables.
  nolof,     %% Prints the List of Figures. Replace with `nolof` to
           %% hide the List of Figures.
  nolot,     %% Prints the List of Tables. Replace with `nolot` to
           %% hide the List of Tables.
  nopalatino, %% Disable palatino globally, enable later using packages
              %% for normal text, not mathmode
  %% More options are listed in the user guide at
  %% <http://mirrors.ctan.org/macros/latex/contrib/fithesis/guide/mu/fi.pdf>.
]{fithesis3}

%% The following section sets up the locales used in the thesis.
\usepackage[resetfonts]{cmap} %% cmap makes the PDF searchable and copyable

% Following packages are enabled by fithesis palatino option
\usepackage{lmodern}
% \usepackage{mathpazo} % Palatino font for mathematics, breaks nice \mathbb
\usepackage{tgpagella} % Palatino font for normal text

\usepackage[T1]{fontenc}
\usepackage[
  main=english, %% By using `czech` or `slovak` as the main locale
                %% instead of `english`, you can typeset the thesis
                %% in either Czech or Slovak, respectively.
  czech         %% The additional keys allow
]{babel}        %% foreign texts to be typeset as follows:
%%
%%   \begin{otherlanguage}{czech}   ... \end{otherlanguage}

%% The following section sets up the metadata of the thesis.
\thesissetup{
    date          = \the\year/\the\month/\the\day,
    university    = mu,
    faculty       = fi,
    type          = d,
    author        = Petr Velan,
    gender        = m,
    advisor       = {doc. Ing. Pavel Čeleda, Ph.D.},
    title         = {Next Generation Application-Aware Flow Monitoring},
    TeXtitle      = {Next Generation Application-Aware Flow Monitoring},
    keywords      = {network, monitoring, network flow, NetFlow, IPFIX, performance, 100Gbps},
    TeXkeywords   = {network, monitoring, network flow, NetFlow, IPFIX, performance, 100\,Gbps},
    bib           = {bibliography.bib,publications.bib,rfcused.bib},
}
\thesislong{abstract}{
    This is the abstract of my thesis, which can

    span multiple paragraphs.

\itodo{
Main contributions:\\
- Flow definition\\
- High-speed flow monitoring (100G, 2x80G)\\
- Addition of application layer information to flow monitoring\\
- Analysis of impact of traffic composition on application flow monitoring\\
- Proposal of new generation of application flow measurement - EventFlow \\

Other contributions\\
- Design of flexible flow collector for application flow processing\\
- Implementation of flexible IPFIX export for flowmon exporter\\
- Survey of methods for encrypted traffic classification\\

TODO: discuss privacy issues (where?)
}
}

\thesislong{thanks}{
    This is the acknowledgement for my thesis, which can

    span multiple paragraphs.
}

\usepackage{makeidx}      %% The `makeidx` package contains
\makeindex                %% helper commands for index typesetting.
%% These additional packages are used within the document:
% \usepackage{paralist}     %% Compact list environments
\usepackage{amsmath}      %% Mathematics
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage[hyphens]{url} %% Hyperlinks
% \usepackage{markdown}     %% Lightweight Markup

% override the default iso-numeric bibtex style by loading the package ourselves
\usepackage[backend=biber,
%         style=,
        sorting=none,
        autolang=other,
        sortlocale=auto]{biblatex}

% clear unnecessary fields that might be filled in the bib files.
% \AtEveryBibitem affects only bibliography, \AtEveryCitekey to affect the \fullcite command as well
% example: \AtEveryCitekey{\ifentrytype{incollection}{\clearfield{doi}}{}}

% Using \DeclareSourcemap is preferred as it prevents the entries from getting into the .bbl file in the first place
% keep editors only for books
\DeclareSourcemap{
  \maps[datatype=bibtex]{
    \map{ % remove url related field from article, inproceedings and incollection
      \pertype{article}
      \pertype{inproceedings}
      \pertype{incollection}
      \step[fieldset=url, null]
      \step[fieldset=urlday, null]
      \step[fieldset=urlmonth, null]
      \step[fieldset=urlyear, null]
      \step[fieldset=urldateera, null]
    }
    \map{ % remove doi from inproceedings and incollection
      \pertype{inproceedings}
      \pertype{incollection}
      \step[fieldset=doi, null]
    }
    \map{ % remove editors from all types except inbook
      \pernottype{inbook}
      \step[fieldset=editor, null]
    }
  }
}

% TO-DO notes
\usepackage{xargs}
\usepackage[dvipsnames]{xcolor}
\usepackage[colorinlistoftodos,prependcaption,textsize=small,textwidth=35mm]{todonotes}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommandx{\improve}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}
\newcommandx{\itodo}[2][1=]{\todo[inline,#1]{#2}}
\newcommandx{\iunsure}[2][1=]{\unsure[inline,#1]{#2}}
\newcommandx{\ichange}[2][1=]{\change[inline,#1]{#2}}
\newcommandx{\iinfo}[2][1=]{\info[inline,#1]{#2}}
\newcommandx{\iimprove}[2][1=]{\improve[inline,#1]{#2}}

% Following fixes use of cline in tables, which is broken by 
% czech babel (- is made into active character)
\makeatletter
\begingroup
\toks0=\expandafter{\@cline{#1}-{#2}\@nil}
\@ifpackageloaded{booktabs}{%
  \toks2=\expandafter{\@@@cmidrule[{#1}-{#2}]{#3}{#4}}%
}{}
\catcode`-=\active
\edef\x{\gdef\unexpanded{\@cline#1-#2\@nil}{\the\toks0}}\x
\@ifpackageloaded{booktabs}{%
  \edef\x{\gdef\unexpanded{\@@@cmidrule[#1-#2]#3#4}{\the\toks2}}\x
}{}
\endgroup
\makeatother

% Definitions style using amsthm package
\newtheoremstyle{defnstyle} % name
    {1em}                        % Space above
    {1em}                        % Space below
    {\itshape}                   % Body font
    {}                           % Indent amount
    {\bfseries}                  % Theorem head font
    {\newline}                   % Punctuation after theorem head
    {.5em}                       % Space after theorem head
    {}  % Theorem head spec (can be left empty, meaning ‘normal’)

\theoremstyle{defnstyle}
\newtheorem{defn}{Definition}[chapter]
\newtheorem*{defnn}{Definition}

% \usepackage{graphicx}
% \usepackage{a4wide}
\usepackage{tabularx}
% \usepackage{amssymb}
% \usepackage[hyphens]{url}
% \usepackage[titletoc]{appendix}
% \usepackage{color}
\usepackage{textcomp} % itemize bullet symbol font
% \usepackage[hidelinks]{hyperref}
\usepackage{pifont}
% \usepackage[table]{xcolor}
% \usepackage{subfig}
% \floatsetup[figure]{style=plain,subcapbesideposition=center}
% \usepackage[ruled, lined, linesnumbered,norelsize]{algorithm2e}
\usepackage{multirow} % Complex tables
\usepackage{booktabs} % \toprule, \midrule, \bottomrule
\usepackage{enumitem} % Allows to use [noitemsep] in itemize and enumerate enviroment definitions
\usepackage[boxed, chapter]{algorithm}
\usepackage{algorithmic}
\usepackage{rotating}
\usepackage{varwidth} % Rotated table with caption
\usepackage{tabu}
\usepackage{bigstrut}

% Environment for chapter introductions (use \setlength{\parindent}{15pt} to indent paragraphs)
\newenvironment{chapintro}
{\begin{displayquote}\setlist[itemize]{leftmargin=*,after=\vspace*{-\baselineskip}}\itshape\leftskip=-5mm\rightskip=-5mm}
{\end{displayquote}}

% Define our own compactitem list
\newlist{compactitem}{itemize}{3} % 3 is max-depth
\setlist[compactitem]{label=\textbullet,leftmargin=*,nosep,after=\vspace*{-\baselineskip}}

% Define indexmacro that does repeat the keyword
\newcommand\Index[1]{#1\index{#1}}

% Checkmark deffinition
\newcommand{\cmark}{\raisebox{-1pt}{\ding{51}}}%
\newcommand{\xmark}{}%

% Load packages required by fithesis. We can setup those packages after this point
\thesisload

% Quotes in italics with centered reference (package csquotes)
\renewcommand{\mkbegdispquote}[2]{\itshape}
\renewcommand{\mkenddispquote}[2]{\par\centering #1#2}

% Environment for definitions using csquotes for centering
\newenvironment{definition}{\begin{displayquote}\vspace{-2em}\begin{defn}}
{\end{defn}\end{displayquote}}

% Make multiple authors be printed as first et al. (package biblatex)
\ExecuteBibliographyOptions{maxnames=999, maxcitenames=2}

% This removes a warning about missing font shape (sl used in \printbibliography)
\makeatletter
\input{ts1qpl.fd}
\makeatother
\DeclareFontShape{TS1}{qpl}{m}{sl}{<->ssub * qpl/m/it}{}

% This removes a warning about missing font shape (ls used in toc)
\makeatletter
\input{t1qpl.fd}
\makeatother
\DeclareFontShape{T1}{qpl}{m}{sl}{<->ssub * qpl/m/it}{}

% supress warning about mutliple page groups in included pdfs
\pdfsuppresswarningpagegroup=1

% We want to use the AMSb symbol for mathbb
\DeclareSymbolFontAlphabet{\mathbb}{AMSb}

\begin{document}

%------------------------------------------------------------------------------
% Include all chapters

\include{chapters/01-introduction}

\include{chapters/02-network-flow-monitoring}

\include{chapters/03-application-flow-monitoring}

\include{chapters/04-flow-monitoring-use-cases}

\include{chapters/05-flow-monitoring-performance}

\include{chapters/06-measurement-of-encrypted-traffic}

\include{chapters/07-next-generation-flow}

\include{chapters/08-conclusions}

%------------------------------------------------------------------------------

% Print bibliography at the end (should happen automatically,
% but this removes overleaf's warning)
\printbibliography[heading=bibintoc] %% Print the bibliography.

%------------------------------------------------------------------------------

% Print index
\makeatletter\thesis@blocks@clear\makeatother
\phantomsection %% Print the index and insert it into the
\addcontentsline{toc}{chapter}{\indexname} %% table of contents.
\printindex

%------------------------------------------------------------------------------

\appendix %% Start the appendices.
% List of authored publications

% Redefine fullcite to print all names, not just maxcitenames
\preto\fullcite{\AtNextCite{\defcounter{maxnames}{99}}}
\include{chapters/10-publication-list}
\itodo{add AIMS2017 and TMA2017 papers}

\end{document}
